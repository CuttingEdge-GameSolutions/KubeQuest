<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KubeQuest</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #0a0a23;
            color: #00ffcc;
            font-family: 'Courier New', monospace;
        }
        .splitpanes__pane {
            width: 100%;
        }
        .game-header {
            text-align: center;
        }
        .stars-container {
            display: flex;
            justify-content: center;
            gap: 5px;
        }
        .star {
            width: 20px;
            height: 20px;
            background: #ffff00;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
        }
        .stat-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 10px 0;
        }
        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .stat-icon {
            font-size: 1.2em;
        }
        .level-container {
            padding: 10px;
        }
        .level-description {
            margin-bottom: 20px;
        }
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #1a1a3d;
            border: 1px solid #ff00ff;
        }
        .progress-fill {
            height: 100%;
            background: #00ffcc;
            transition: width 0.5s ease-in-out;
        }
        .mission-container {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ff00ff;
            background: #1a1a3d;
        }
        .mission-header {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .mission-badge {
            background: #ff00ff;
            color: #0a0a23;
            padding: 5px 10px;
            font-weight: bold;
        }
        .command-container {
            margin: 10px 0;
        }
        .terminal-header {
            background: #ff00ff;
            padding: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .terminal-dot {
            width: 10px;
            height: 10px;
            background: #00ffcc;
            border-radius: 50%;
        }
        .terminal-title {
            color: #0a0a23;
            font-weight: bold;
        }
        .command-wrapper {
            display: none; /* Hide the terminal command and copy button by default */
        }
        .command-code {
            display: block;
            background: #0a0a23;
            padding: 10px;
            border: 1px solid #ff00ff;
            color: #00ffcc;
            white-space: pre-wrap;
            margin-bottom: 5px;
        }
        .hint-btn, .copy-btn, .reset-btn {
            padding: 5px 10px;
            background: #ff00ff;
            color: #0a0a23;
            border: none;
            cursor: pointer;
            transition: transform 0.1s ease;
        }
        .hint-btn:hover, .copy-btn:hover, .reset-btn:hover {
            transform: scale(1.05);
        }
        .pulse-animation {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .hint {
            margin-top: 10px;
            padding: 10px;
            background: #1a1a3d;
            border: 1px solid #00ffcc;
            color: #00ffcc;
            display: none; /* Ensure hints are hidden by default */
        }
        .mission-label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        .checkmark {
            width: 20px;
            height: 20px;
            border: 2px solid #ff00ff;
            background: #0a0a23;
            position: relative;
        }
        .mission-label input:checked + .checkmark::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #00ffcc;
            font-size: 1.2em;
        }
        .success-msg {
            display: none; /* Hide success message by default */
            margin-top: 10px;
            padding: 10px;
            background: #1a1a3d;
            border: 1px solid #00ffcc;
            color: #00ffcc;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .success-icon {
            font-size: 1.2em;
            color: #00ffcc;
        }
        .achievements-container {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ff00ff;
            background: #1a1a3d;
        }
        .achievement {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 5px 0;
        }
        .achievement-icon {
            font-size: 1.2em;
            color: #ffff00;
        }
        .achievements-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="splitpanes__pane" style="width: 100%;">
        <div style="background:#0a0a23;color:#00ffcc;font-family:'Courier New',monospace;padding:15px;height:100%;overflow-y:auto;">
            <div class="game-header">
                <h1 style="color:#ff00ff;text-shadow:0 0 10px #00ffcc;text-align:center;font-size:2.5em;margin-bottom:5px;">KubeQuest</h1>
                <div class="stars-container">
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                </div>
                <p style="text-align:center;margin-top:5px;">Welcome, Engineer! Your mission: stabilize the galactic cluster network!</p>
                <div class="stat-bar">
                    <div class="stat-item">
                        <span class="stat-icon">‚≠ê</span>
                        <span style="color:#ffff00;" id="score">Score: 0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">üîã</span>
                        <span id="energy">Energy: 100%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">üèÜ</span>
                        <span id="rank">Rank: Cadet</span>
                    </div>
                </div>
                <div style="text-align:center;margin:10px 0;">
                    <select id="levelSelector" onchange="changeLevel()" style="background:#1a1a3d;color:#00ffcc;border:2px solid #ff00ff;padding:5px;">
                        <option value="1">Level 1: Cluster Basics</option>
                        <option value="2">Level 2: Deployments & Services</option>
                        <option value="3">Level 3: Configuration & Storage</option>
                        <option value="4">Level 4: Advanced Networking</option>
                        <option value="5">Level 5: Security & Troubleshooting</option>
                    </select>
                </div>
            </div>

            <!-- Achievements Section -->
            <div class="achievements-container">
                <div class="achievements-header">
                    <h3 style="color:#ff00ff;">Achievements</h3>
                    <button class="reset-btn" onclick="resetAllProgress()">Reset All Progress</button>
                </div>
                <div id="achievements-list">
                    <!-- Achievements will be dynamically added here -->
                </div>
            </div>

            <!-- Level 1 Missions -->
            <div id="level1" class="level-container">
                <h2 style="color:#ffff00;text-align:center;">Level 1: Cluster Basics</h2>
                <div class="level-description">
                    <p style="text-align:center;color:#00ffcc;">The galactic federation's outpost needs basic reconnaissance.</p>
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div id="progress-level1" class="progress-fill" style="width:0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">01</span>
                        <h3 style="color:#ff00ff;">Mission 1.1: Deploy Scout Pod</h3>
                    </div>
                    <p style="color:#00ffcc;">Deploy a single nginx pod to scan for alien signals.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command1-1" class="command-wrapper">
                            <code class="command-code">kubectl run scout-pod --image=nginx --restart=Never</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl run scout-pod --image=nginx --restart=Never')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-1-1" onclick="toggleHint('hint1-1', 'command1-1')">Hint</button>
                        <div id="hint1-1" class="hint">Use kubectl run with nginx image to create a non-restarting pod</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 10, '1-1')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success1-1" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Scout pod deployed. +10 points
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">02</span>
                        <h3 style="color:#ff00ff;">Mission 1.2: Pod Intelligence</h3>
                    </div>
                    <p style="color:#00ffcc;">Get detailed information about the scout pod.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command1-2" class="command-wrapper">
                            <code class="command-code">kubectl describe pod scout-pod</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl describe pod scout-pod')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-1-2" onclick="toggleHint('hint1-2', 'command1-2')">Hint</button>
                        <div id="hint1-2" class="hint">Use kubectl describe to get detailed information about resources</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 15, '1-2')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success1-2" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Pod details retrieved. +15 points
                    </div>
                </div>

                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">03</span>
                        <h3 style="color:#ff00ff;">Mission 1.3: Pod Logs</h3>
                    </div>
                    <p style="color:#00ffcc;">Check the scout pod's communications log.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command1-3" class="command-wrapper">
                            <code class="command-code">kubectl logs scout-pod</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl logs scout-pod')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-1-3" onclick="toggleHint('hint1-3', 'command1-3')">Hint</button>
                        <div id="hint1-3" class="hint">Use kubectl logs to view pod output</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 15, '1-3')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success1-3" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Communications log retrieved. +15 points
                    </div>
                </div>
            </div>

            <!-- Level 2 Missions -->
            <div id="level2" class="level-container" style="display:none;">
                <h2 style="color:#ffff00;text-align:center;">Level 2: Deployments & Services</h2>
                <div class="level-description">
                    <p style="text-align:center;color:#00ffcc;">The outpost needs to expand its fleet and establish communications.</p>
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div id="progress-level2" class="progress-fill" style="width:0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">01</span>
                        <h3 style="color:#ff00ff;">Mission 2.1: Deploy Fleet</h3>
                    </div>
                    <p style="color:#00ffcc;">Deploy a fleet of 3 nginx pods using Deployments.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command2-1" class="command-wrapper">
                            <code class="command-code">kubectl create deployment fleet --image=nginx --replicas=3</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl create deployment fleet --image=nginx --replicas=3')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-2-1" onclick="toggleHint('hint2-1', 'command2-1')">Hint</button>
                        <div id="hint2-1" class="hint">Use kubectl create deployment with the --replicas flag</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 20, '2-1')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success2-1" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Fleet deployed. +20 points
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">02</span>
                        <h3 style="color:#ff00ff;">Mission 2.2: Fleet Scaling</h3>
                    </div>
                    <p style="color:#00ffcc;">Increase fleet size to 5 pods to extend scanning range.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command2-2" class="command-wrapper">
                            <code class="command-code">kubectl scale deployment fleet --replicas=5</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl scale deployment fleet --replicas=5')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-2-2" onclick="toggleHint('hint2-2', 'command2-2')">Hint</button>
                        <div id="hint2-2" class="hint">Use kubectl scale to change the number of replicas</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 20, '2-2')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success2-2" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Fleet expanded. +20 points
                    </div>
                </div>

                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">03</span>
                        <h3 style="color:#ff00ff;">Mission 2.3: Communication Service</h3>
                    </div>
                    <p style="color:#00ffcc;">Create a service to enable fleet communications.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command2-3" class="command-wrapper">
                            <code class="command-code">kubectl expose deployment fleet --port=80 --type=NodePort --name=fleet-comms</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl expose deployment fleet --port=80 --type=NodePort --name=fleet-comms')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-2-3" onclick="toggleHint('hint2-3', 'command2-3')">Hint</button>
                        <div id="hint2-3" class="hint">Use kubectl expose to create a service from a deployment</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 25, '2-3')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success2-3" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Communication service established. +25 points
                    </div>
                </div>
            </div>

            <!-- Level 3 Missions -->
            <div id="level3" class="level-container" style="display:none;">
                <h2 style="color:#ffff00;text-align:center;">Level 3: Configuration & Storage</h2>
                <div class="level-description">
                    <p style="text-align:center;color:#00ffcc;">Secure configurations and data storage are needed for long-term operations.</p>
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div id="progress-level3" class="progress-fill" style="width:0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">01</span>
                        <h3 style="color:#ff00ff;">Mission 3.1: Secret Intelligence</h3>
                    </div>
                    <p style="color:#00ffcc;">Create a secret to store sensitive communication codes.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command3-1" class="command-wrapper">
                            <code class="command-code">kubectl create secret generic comm-codes --from-literal=access_key=galactic-1138 --from-literal=secret_key=r2d2-c3po</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl create secret generic comm-codes --from-literal=access_key=galactic-1138 --from-literal=secret_key=r2d2-c3po')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-3-1" onclick="toggleHint('hint3-1', 'command3-1')">Hint</button>
                        <div id="hint3-1" class="hint">Use kubectl create secret generic with --from-literal for key-value pairs</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 25, '3-1')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success3-1" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Secret intelligence secured. +25 points
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">02</span>
                        <h3 style="color:#ff00ff;">Mission 3.2: ConfigMap Relay</h3>
                    </div>
                    <p style="color:#00ffcc;">Create a ConfigMap with non-sensitive relay configurations.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command3-2" class="command-wrapper">
                            <code class="command-code">kubectl create configmap relay-config --from-literal=broadcast_freq=384.5 --from-literal=protocol=quantum-tcp</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl create configmap relay-config --from-literal=broadcast_freq=384.5 --from-literal=protocol=quantum-tcp')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-3-2" onclick="toggleHint('hint3-2', 'command3-2')">Hint</button>
                        <div id="hint3-2" class="hint">Use kubectl create configmap with --from-literal for key-value pairs</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 25, '3-2')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success3-2" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Relay configuration created. +25 points
                    </div>
                </div>

                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">03</span>
                        <h3 style="color:#ff00ff;">Mission 3.3: Persistent Data Storage</h3>
                    </div>
                    <p style="color:#00ffcc;">Create a PersistentVolumeClaim for storing long-term mission data.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command3-3" class="command-wrapper">
                            <code class="command-code">kubectl apply -f - << EOF
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mission-data
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
EOF</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl apply -f - << EOF\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: mission-data\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 1Gi\nEOF')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-3-3" onclick="toggleHint('hint3-3', 'command3-3')">Hint</button>
                        <div id="hint3-3" class="hint">Create a PVC with ReadWriteOnce access mode and request 1Gi of storage</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 30, '3-3')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success3-3" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Persistent storage established. +30 points
                    </div>
                </div>
            </div>

            <!-- Level 4 Missions -->
            <div id="level4" class="level-container" style="display:none;">
                <h2 style="color:#ffff00;text-align:center;">Level 4: Advanced Networking</h2>
                <div class="level-description">
                    <p style="text-align:center;color:#00ffcc;">Establish secure network pathways across the galactic cluster.</p>
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div id="progress-level4" class="progress-fill" style="width:0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">01</span>
                        <h3 style="color:#ff00ff;">Mission 4.1: Ingress Gateway</h3>
                    </div>
                    <p style="color:#00ffcc;">Create an Ingress resource to route external traffic.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command4-1" class="command-wrapper">
                            <code class="command-code">kubectl apply -f - << EOF
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: fleet-gateway
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - http:
      paths:
      - path: /fleet
        pathType: Prefix
        backend:
          service:
            name: fleet-comms
            port:
              number: 80
EOF</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl apply -f - << EOF\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: fleet-gateway\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\nspec:\n  rules:\n  - http:\n      paths:\n      - path: /fleet\n        pathType: Prefix\n        backend:\n          service:\n            name: fleet-comms\n            port:\n              number: 80\nEOF')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-4-1" onclick="toggleHint('hint4-1', 'command4-1')">Hint</button>
                        <div id="hint4-1" class="hint">Create an Ingress resource that routes /fleet to your fleet-comms service</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 35, '4-1')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success4-1" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Ingress gateway established. +35 points
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">02</span>
                        <h3 style="color:#ff00ff;">Mission 4.2: Network Policies</h3>
                    </div>
                    <p style="color:#00ffcc;">Implement a Network Policy to restrict unauthorized communication.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command4-2" class="command-wrapper">
                            <code class="command-code">kubectl apply -f - << EOF
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: fleet-security
spec:
  podSelector:
    matchLabels:
      app: fleet
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          role: authorized
    ports:
    - protocol: TCP
      port: 80
  egress:
  - to:
    - podSelector:
        matchLabels:
          role: database
    ports:
    - protocol: TCP
      port: 5432
EOF</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl apply -f - << EOF\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: fleet-security\nspec:\n  podSelector:\n    matchLabels:\n      app: fleet\n  policyTypes:\n  - Ingress\n  - Egress\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          role: authorized\n    ports:\n    - protocol: TCP\n      port: 80\n  egress:\n  - to:\n    - podSelector:\n        matchLabels:\n          role: database\n    ports:\n    - protocol: TCP\n      port: 5432\nEOF')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-4-2" onclick="toggleHint('hint4-2', 'command4-2')">Hint</button>
                        <div id="hint4-2" class="hint">Create a NetworkPolicy with specific ingress and egress rules</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 40, '4-2')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success4-2" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! Network security enforced. +40 points
                    </div>
                </div>
            </div>

            <!-- Level 5 Missions -->
            <div id="level5" class="level-container" style="display:none;">
                <h2 style="color:#ffff00;text-align:center;">Level 5: Security & Troubleshooting</h2>
                <div class="level-description">
                    <p style="text-align:center;color:#00ffcc;">Secure the cluster and repair critical systems.</p>
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div id="progress-level5" class="progress-fill" style="width:0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="mission-container">
                    <div class="mission-header">
                        <span class="mission-badge">01</span>
                        <h3 style="color:#ff00ff;">Mission 5.1: RBAC Security</h3>
                    </div>
                    <p style="color:#00ffcc;">Create a Role and RoleBinding for secure fleet operations.</p>
                    <div class="command-container">
                        <div class="terminal-header">
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-dot"></span>
                            <span class="terminal-title">galactic-terminal</span>
                        </div>
                        <div id="command5-1" class="command-wrapper">
                            <code class="command-code">kubectl apply -f - << EOF
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: default
  name: fleet-operator
rules:
- apiGroups: [""]
  resources: ["pods", "services"]
  verbs: ["get", "list", "watch"]
- apiGroups: ["apps"]
  resources: ["deployments"]
  verbs: ["get", "list", "watch", "update"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: fleet-operator-binding
  namespace: default
subjects:
- kind: ServiceAccount
  name: fleet-sa
  namespace: default
roleRef:
  kind: Role
  name: fleet-operator
  apiGroup: rbac.authorization.k8s.io
EOF</code>
                            <button class="copy-btn" onclick="copyToClipboard('kubectl apply -f - << EOF\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: default\n  name: fleet-operator\nrules:\n- apiGroups: [\"\"]\n  resources: [\"pods\", \"services\"]\n  verbs: [\"get\", \"list\", \"watch\"]\n- apiGroups: [\"apps\"]\n  resources: [\"deployments\"]\n  verbs: [\"get\", \"list\", \"watch\", \"update\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: fleet-operator-binding\n  namespace: default\nsubjects:\n- kind: ServiceAccount\n  name: fleet-sa\n  namespace: default\nroleRef:\n  kind: Role\n  name: fleet-operator\n  apiGroup: rbac.authorization.k8s.io\nEOF')">Copy</button>
                        </div>
                        <button class="hint-btn pulse-animation" id="hint-btn-5-1" onclick="toggleHint('hint5-1', 'command5-1')">Hint</button>
                        <div id="hint5-1" class="hint">Create a Role with limited permissions and bind it to a ServiceAccount</div>
                    </div>
                    <label class="mission-label">
                        <input type="checkbox" onchange="updateProgress(this, 45, '5-1')"> 
                        <span class="checkmark"></span>
                        <span>Mission Complete</span>
                    </label>
                    <div id="success5-1" class="success-msg">
                        <div class="success-icon">‚úì</div>
                        Success! RBAC security implemented. +45 points
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let energy = 100;
        let achievements = new Set();

        // Load progress from local storage
        function loadProgress() {
            const savedState = localStorage.getItem('kubeQuestProgress');
            if (savedState) {
                const state = JSON.parse(savedState);
                document.getElementById('score').textContent = `Score: ${state.score}`;
                energy = state.energy;
                document.getElementById('energy').textContent = `Energy: ${Math.round(energy)}%`;
                document.getElementById('rank').textContent = `Rank: ${state.rank}`;
                document.getElementById('levelSelector').value = state.currentLevel;

                // Restore completed missions
                state.completedMissions.forEach(missionId => {
                    const checkbox = document.querySelector(`input[onchange*="'${missionId}'"]`);
                    if (checkbox) {
                        checkbox.checked = true;
                        document.getElementById(`success${missionId}`).style.display = 'flex';
                        // Also show the command and hint if the mission is completed
                        const commandWrapper = document.getElementById(`command${missionId}`);
                        const hintDiv = document.getElementById(`hint${missionId}`);
                        const hintBtn = document.getElementById(`hint-btn-${missionId}`);
                        if (commandWrapper && hintDiv && hintBtn) {
                            commandWrapper.style.display = 'block';
                            hintDiv.style.display = 'block';
                            hintBtn.textContent = 'Hide Hint';
                        }
                    }
                });

                // Restore progress bars
                for (let level = 1; level <= 5; level++) {
                    const totalMissions = document.querySelectorAll(`#level${level} .mission-container`).length;
                    const completedMissions = document.querySelectorAll(`#level${level} .mission-label input:checked`).length;
                    const progress = (completedMissions / totalMissions) * 100;
                    document.getElementById(`progress-level${level}`).style.width = `${progress}%`;
                }

                // Restore achievements
                state.achievements.forEach(achievement => achievements.add(achievement));
                updateAchievements();
            }
            changeLevel();
            startEnergyRecharge();
        }

        // Save progress to local storage
        function saveProgress() {
            const state = {
                score: parseInt(document.getElementById('score').textContent.split(': ')[1]),
                energy: energy,
                rank: document.getElementById('rank').textContent.split(': ')[1],
                currentLevel: document.getElementById('levelSelector').value,
                completedMissions: Array.from(document.querySelectorAll('.mission-label input:checked')).map(checkbox => checkbox.getAttribute('onchange').match(/'[^']+'/)[0].slice(1, -1)),
                achievements: Array.from(achievements)
            };
            localStorage.setItem('kubeQuestProgress', JSON.stringify(state));
        }

        // Reset all progress
        function resetAllProgress() {
            if (confirm("Are you sure you want to reset all progress? This will clear your score, energy, missions, and achievements.")) {
                // Clear local storage
                localStorage.removeItem('kubeQuestProgress');

                // Reset achievements
                achievements.clear();

                // Reset game state
                energy = 100;
                document.getElementById('score').textContent = 'Score: 0';
                document.getElementById('energy').textContent = 'Energy: 100%';
                document.getElementById('rank').textContent = 'Rank: Cadet';
                document.getElementById('levelSelector').value = '1';

                // Uncheck all mission checkboxes and hide success messages, hints, and commands
                document.querySelectorAll('.mission-label input').forEach(checkbox => {
                    checkbox.checked = false;
                    const missionId = checkbox.getAttribute('onchange').match(/'[^']+'/)[0].slice(1, -1);
                    document.getElementById(`success${missionId}`).style.display = 'none';
                    const commandWrapper = document.getElementById(`command${missionId}`);
                    const hintDiv = document.getElementById(`hint${missionId}`);
                    const hintBtn = document.getElementById(`hint-btn-${missionId}`);
                    if (commandWrapper && hintDiv && hintBtn) {
                        commandWrapper.style.display = 'none';
                        hintDiv.style.display = 'none';
                        hintBtn.textContent = 'Hint';
                    }
                });

                // Reset progress bars
                for (let level = 1; level <= 5; level++) {
                    document.getElementById(`progress-level${level}`).style.width = '0%';
                }

                // Update achievements UI
                updateAchievements();

                // Reset to Level 1
                changeLevel();
            }
        }

        // Energy recharge system
        function startEnergyRecharge() {
            setInterval(() => {
                if (energy < 100) {
                    energy = Math.min(100, energy + 0.5); // Recharge 0.5% every second
                    document.getElementById('energy').textContent = `Energy: ${Math.round(energy)}%`;
                    saveProgress();
                }
            }, 1000);
        }

        function toggleHint(hintId, commandId) {
            if (energy < 5) {
                alert("Not enough energy to reveal a hint! Wait for energy to recharge.");
                return;
            }

            const hintDiv = document.getElementById(hintId);
            const commandWrapper = document.getElementById(commandId);
            const hintBtn = document.getElementById(`hint-btn-${hintId.replace('hint', '')}`);
            
            if (hintDiv.style.display === "none" || hintDiv.style.display === "") {
                hintDiv.style.display = "block";
                commandWrapper.style.display = "block";
                hintBtn.textContent = "Hide Hint";
                energy -= 5; // Consume 5% energy for revealing a hint
                document.getElementById('energy').textContent = `Energy: ${Math.round(energy)}%`;
            } else {
                hintDiv.style.display = "none";
                commandWrapper.style.display = "none";
                hintBtn.textContent = "Hint";
            }
            saveProgress();
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert("Command copied to clipboard!");
            });
        }

        function updateProgress(checkbox, points, missionId) {
            if (energy < 10 && checkbox.checked) {
                alert("Not enough energy to complete a mission! Wait for energy to recharge.");
                checkbox.checked = false;
                return;
            }

            const level = missionId.split('-')[0];
            const progressBar = document.getElementById(`progress-level${level}`);
            const successMsg = document.getElementById(`success${missionId}`);
            const scoreElement = document.getElementById('score');
            let score = parseInt(scoreElement.textContent.split(': ')[1]);

            if (checkbox.checked) {
                successMsg.style.display = 'flex';
                score += points;
                scoreElement.textContent = `Score: ${score}`;
                energy -= 10; // Consume 10% energy for completing a mission
                document.getElementById('energy').textContent = `Energy: ${Math.round(energy)}%`;

                const totalMissions = document.querySelectorAll(`#level${level} .mission-container`).length;
                const completedMissions = document.querySelectorAll(`#level${level} .mission-label input:checked`).length;
                const progress = (completedMissions / totalMissions) * 100;
                progressBar.style.width = `${progress}%`;

                updateRank(score);
                checkAchievements(missionId);

                // Check if the level is complete
                if (completedMissions === totalMissions) {
                    const currentLevel = parseInt(level);
                    if (currentLevel < 5) { // Only prompt if not on the last level
                        const proceed = confirm(`Congratulations! You've completed Level ${currentLevel}. Do you want to proceed to Level ${currentLevel + 1}?`);
                        if (proceed) {
                            const levelSelector = document.getElementById('levelSelector');
                            levelSelector.value = currentLevel + 1;
                            changeLevel();
                        }
                    } else {
                        alert("Congratulations! You've completed all levels of KubeQuest!");
                    }
                }
            } else {
                successMsg.style.display = 'none';
                score -= points;
                scoreElement.textContent = `Score: ${score}`;
                energy += 10; // Refund energy if mission is unchecked
                document.getElementById('energy').textContent = `Energy: ${Math.round(energy)}%`;

                const totalMissions = document.querySelectorAll(`#level${level} .mission-container`).length;
                const completedMissions = document.querySelectorAll(`#level${level} .mission-label input:checked`).length;
                const progress = (completedMissions / totalMissions) * 100;
                progressBar.style.width = `${progress}%`;

                updateRank(score);
            }
            saveProgress();
        }

        function updateRank(score) {
            const rankElement = document.getElementById('rank');
            if (score >= 300) {
                rankElement.textContent = 'Rank: Galactic Commander';
            } else if (score >= 200) {
                rankElement.textContent = 'Rank: Fleet Admiral';
            } else if (score >= 100) {
                rankElement.textContent = 'Rank: Captain';
            } else if (score >= 50) {
                rankElement.textContent = 'Rank: Lieutenant';
            } else {
                rankElement.textContent = 'Rank: Cadet';
            }
        }

        function checkAchievements(missionId) {
            if (missionId === '1-1' && !achievements.has('First Deployment')) {
                achievements.add('First Deployment');
                addAchievement('First Deployment', 'Deployed your first pod!');
            }
            if (missionId === '1-2' && !achievements.has('Pod Inspector')) {
                achievements.add('Pod Inspector');
                addAchievement('Pod Inspector', 'Inspected pod details!');
            }
            if (missionId === '2-1' && !achievements.has('Fleet Commander')) {
                achievements.add('Fleet Commander');
                addAchievement('Fleet Commander', 'Deployed a fleet of pods!');
            }
            saveProgress();
        }

        function addAchievement(name, description) {
            const achievementsList = document.getElementById('achievements-list');
            const achievementDiv = document.createElement('div');
            achievementDiv.className = 'achievement';
            achievementDiv.innerHTML = `
                <span class="achievement-icon">üèÖ</span>
                <span>${name}: ${description}</span>
            `;
            achievementsList.appendChild(achievementDiv);
        }

        function updateAchievements() {
            const achievementsList = document.getElementById('achievements-list');
            achievementsList.innerHTML = '';
            achievements.forEach(achievement => {
                let description = '';
                if (achievement === 'First Deployment') description = 'Deployed your first pod!';
                if (achievement === 'Pod Inspector') description = 'Inspected pod details!';
                if (achievement === 'Fleet Commander') description = 'Deployed a fleet of pods!';
                addAchievement(achievement, description);
            });
        }

        function changeLevel() {
            const levelSelector = document.getElementById('levelSelector');
            const selectedLevel = levelSelector.value;

            // Show the selected level and hide others
            for (let i = 1; i <= 5; i++) {
                const levelDiv = document.getElementById(`level${i}`);
                if (i == selectedLevel) {
                    levelDiv.style.display = 'block';
                } else {
                    levelDiv.style.display = 'none';
                }
            }

            // Reset hints and commands for the selected level (unless mission is complete)
            const missions = document.querySelectorAll(`#level${selectedLevel} .mission-container`);
            missions.forEach(mission => {
                const missionId = mission.querySelector('input[type="checkbox"]').getAttribute('onchange').match(/'[^']+'/)[0].slice(1, -1);
                const commandWrapper = document.getElementById(`command${missionId}`);
                const hintDiv = document.getElementById(`hint${missionId}`);
                const hintBtn = document.getElementById(`hint-btn-${missionId}`);
                const checkbox = document.querySelector(`input[onchange*="'${missionId}'"]`);

                if (!checkbox.checked) { // Only reset if the mission is not completed
                    if (commandWrapper && hintDiv && hintBtn) {
                        commandWrapper.style.display = 'none';
                        hintDiv.style.display = 'none';
                        hintBtn.textContent = 'Hint';
                    }
                }
            });

            saveProgress();
        }

        // Initialize the game
        window.onload = loadProgress;
    </script>
</body>
</html>
